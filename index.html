<div id="top-wrapper" style="display: flex; flex-direction: column; align-items: center; justify-content: center; width: 100%; margin-top: 10px;">

    <!-- SUA LOGO (inalterada) -->
    <img src="sua-logo.png" id="suaLogo" style="max-width: 160px; height: auto; margin: 0 auto; display: block;">

    <!-- BALÃO DE VAGAS CENTRALIZADO -->
    <div id="vagas-balao" style="
        margin-top: 12px;
        padding: 10px 18px;
        background: #ff4747;
        color: #fff;
        font-size: 20px;
        font-weight: bold;
        border-radius: 8px;
        text-align: center;
        box-shadow: 0 4px 12px rgba(0,0,0,0.18);
        display: inline-block;
        animation: pulseBox 1.3s infinite ease-in-out;
    ">
        Restam <span id="vagas-numero">21</span> vagas
    </div>

</div>


<style>
@keyframes pulseBox {
  0% { transform: scale(1); }
  50% { transform: scale(1.06); }
  100% { transform: scale(1); }
}
</style>


<script>
// ======================
// CONFIGURAÇÕES
// ======================
let vagas = 21;
let tempoMin = 3000;
let tempoMax = 6000;

let slowdownStart = 11;     // início do slowdown (corrigido)
let slowdownHeavy = 4;      // super lento abaixo disso

let popupsAtivos = true;


// ======================
// FUNÇÃO PARA ATUALIZAR BALÃO
// ======================
function atualizarVagas() {
    const elemento = document.getElementById("vagas-numero");
    elemento.textContent = vagas;

    const balao = document.getElementById("vagas-balao");

    // Alerta forte abaixo de 5 vagas
    if (vagas <= 5) {
        balao.style.background = "#c40000";
        balao.style.animation = "pulseBox 0.6s infinite ease-in-out";
    }

    if (vagas <= 0) {
        balao.textContent = "ENCERRADO";
        popupsAtivos = false;
    }
}


// ======================
// REDUZIR VAGAS COM RITMO NATURAL
// ======================
function reduzirVagas() {
    if (vagas <= 0) return;

    vagas--;
    atualizarVagas();

    let proximoTempo;

    if (vagas <= slowdownHeavy) {
        proximoTempo = 18000 + Math.random() * 7000;
    } else if (vagas <= slowdownStart) {
        proximoTempo = 9000 + Math.random() * 4000;
    } else {
        proximoTempo = tempoMin + Math.random() * (tempoMax - tempoMin);
    }

    setTimeout(reduzirVagas, proximoTempo);
}


// ======================
// POPUPS SINCRONIZADOS
// ======================
function iniciarPopups() {
    if (!popupsAtivos || vagas <= 0) return;

    criarPopupEntrada();

    let tempoPopup = Math.random() * 5000 + 5000;

    if (vagas <= slowdownHeavy) {
        tempoPopup = Math.random() * 15000 + 15000;
    } else if (vagas <= slowdownStart) {
        tempoPopup = Math.random() * 9000 + 9000;
    }

    setTimeout(iniciarPopups, tempoPopup);
}

function criarPopupEntrada() {
    const nomes = ["Lucas", "Amanda", "Carla", "Pedro", "Mateus", "João", "Fernanda", "Paula", "Rafael", "Larissa", "Tiago"];
    const nome = nomes[Math.floor(Math.random() * nomes.length)];

    const popup = document.createElement("div");
    popup.className = "popup-entrada";
    popup.innerText = `${nome} entrou no grupo.`;

    document.body.appendChild(popup);

    setTimeout(() => {
        popup.style.opacity = "0";
        popup.style.transform = "translateX(150px)";
    }, 4000);

    setTimeout(() => popup.remove(), 5500);
}

const estiloPopup = document.createElement("style");
estiloPopup.innerHTML = `
.popup-entrada {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: #222;
    color: #fff;
    padding: 12px 16px;
    border-radius: 6px;
    font-size: 15px;
    font-weight: 500;
    opacity: 1;
    transition: 1s ease;
    box-shadow: 0 4px 10px rgba(0,0,0,0.25);
}
`;
document.head.appendChild(estiloPopup);


// ======================
// INICIAR TUDO
// ======================
setTimeout(reduzirVagas, 4000);
setTimeout(iniciarPopups, 6000);
</script>
